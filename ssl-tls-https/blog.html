<p>SSL and TLS are encryption protocols used for security.  For this blog post, I will be talking mostly about its integration with the web Hypertext Transfer Protocol (HTTP).  By running HTTP over SSL/TLS, you enable an extra layer of security in what is commonly known as HTTPS.  Since HTTP is an application layer protocol in the OSI layer model, SSL/TLS acts as a verification middle-man between the application and the server.</p>

<h2>SSL</h2>
<p>In 1993, Netscape introduced SSL, an encryption protocol that would sit between the TCP and Application layer.  Its purpose was to ensure security between the client and the server, but the first version was actually never released because of its severe bugs and flaws.  The first official release was the second version, released in 1995.  Over time, even more bugs have been fixed, and has been put to rest in 2015.  It is now deprecated, and IEFT released a <a href="https://tools.ietf.org/html/rfc7568" target="_blank" rel="noopener noreferrer">2015 statement</a> announcing that everyone should use TLS instead.</p>

<h3>How SSL works</h3>
<p>SSL was meant to be the answer to authentication and authorization problems on the web.  Netscape believed that RSA encryption could take care of this, so the SSL handshake was born.  A different key is created for each client and server connection.</p>
<img class="aligncenter" src="https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_7.1.0/com.ibm.mq.doc/sy10660a.gif" alt="SSL Handshake.  Source: IBM" >
<p>Message digests were also introduced to detect and prevent data tampering.</p>

<h3>Security Issues</h3>
<p>As usual, misconfigured SSL preconditions may lead to man-in-the-middle attacks.  Usually, this means the server key has been stolen by the attacker, or the Certificate Authority has been spoofed/is untrustworthy/has been stolen.  The SSL key exchange relies on weak algorithms, such as SHA-1 and MD5, which makes these attacks much more vulnerable.  SSL is also pretty limited in security, especially compared to what TLS can offer.</p>

<p>The most famous weakness of SSL was an exploit dubbed <a href="https://www.openssl.org/~bodo/ssl-poodle.pdf" target="_blank" rel="noopener noreferrer">'POODLE'</a>, which took advantage of downgrading from TLS back to SSL.  This attack triggered the end of SSL maintenance, which is super hilarious to me.  Death by poodle.</p>

<h2>TLS</h2>
<p>The Transport Layer Security protocol is the more secure successor of SSL.  Its first version was released in 1999, as an upgrade to SSL v3.0.  It has had a few updates since, with the most recent version proposed as of March 21, 2018.  The Payment Card Industry Security Standards Council even suggests that everyone upgrades or migrates to TLS <a href="https://blog.pcisecuritystandards.org/are-you-ready-for-30-june-2018-sayin-goodbye-to-ssl-early-tls" target="_blank" rel="noopener noreferrer">before <b>June 30, 2018</b></a>, which is just around the corner.</p>

<h3>Benefits</h3>
<p>I already mentioned that SSL relied on weak algorithms.  TLS v1.3 has removed support for MD5 and SHA-224 hash functions, and continues to push for even stronger options.  We saw SSL's attempt to protect data with message digests, and now TLS also uses more secure key HMAC to avoid data tampering.  The "Enhanced Pseudorandom Function" is also used to generate key data, using two hash algorithms to increase security.</p>

<h3>Issues</h3>
<p>There have been a couple of cryptographic exploits, such as the <a href="https://sweet32.info" target="_blank" rel="noopener noreferrer">SWEET32/Birthday Attacks</a>, <a href="https://www.contextis.com/blog/server-technologies-https-beast-attack" target="_blank" rel="noopener noreferrer">BEAST</a>, and <a href="https://censys.io/blog/freak" target="_blank" rel="noopener noreferrer">FREAK</a>.  The basic fix for these kinds of vulnerabilities is to disable weak SSL ciphers, and enable strong ones.  There are also issues in RSA and other key negotiations.</p>
<p>I will go into further vulnerability deetails in the <a href="#named-vulnerabilities">named-vulnerabilities</a> section.</p>

<h2>HTTPS</h2>
<!-- <p>HTTP Protocol over SSL/TLS.  Some history.  How it works.  Extra step of protection for requests and other HTTP Activity.</p> -->

<h3>Benefits</h3>

<h3>Issues</h3>
<p>Absolutely all pages should be served over HTTPS.  Failure to server sources such as CSS, scripts, images, and AJAX requests allows room for man-in-the-middle attacks.  This means we have to be super careful about the <a href="#mixed-content">mixed content issue.</a>. It only takes on HTTP request to reach HTTPS pages.  Also remember to preload the <code>HTTP Strict Transport Security</code> header into browsers, and make sure all of your cookies are marked as secure.  Misconfiguration is always going to be an issue.</p>

<h2>Certificates</h2>
<!-- <p>What is and what is in the certificate</p> -->

<h3>Benefits</h3>

<h3>Issues</h3>

<h2>Web Security with HTTPS</h2>
<!-- <p>Intro</p> -->

<h3>Free Cert Options</h3>
<!-- <p>Let's Encrypt</p> -->
<!-- <p>Cloudflare</p> -->

<h3>Monitoring Security</h3>
<!-- <p>CSP Reports</p> -->
<!-- <p>Testing with OWASP testing guide https://www.owasp.org/index.php/Testing_for_SSL-TLS_(OWASP-CM-001)</p> -->

<h2>Implementing HTTPS</h2>
<!-- <p>Background, intro</p> -->

<h3>Mixed Content Issue</h3>
<!-- <p>What it means</p> -->
<!-- <p>Fix with 301 redirects!!!</p> -->

<h3>HSTS</h3>
<!-- <p>Also protects against KRACK, so link to that article</p> -->
<!-- <p>preloading</p> -->

<h2>Known HTTPS Security Issues</h2>
<!-- <p>Serious problems, like cryptographic protocol vulnerabilities in ssl/tls, but can be managed by disabling support for past ssl/tls versions.</p> -->
<!-- <p>Usually compromise of certificate authority or other spoofing.  man in the middle attacks.  Etc.</p> -->

<h3>Named SSL/TLS/HTTPS Attacks</h3>
<p>Aside from POODLE, I have also mentioned SWEET32, FREAK, and BEAST.  Let's talk about those a little more.</p>
<h4>SWEET32 / Birthday Attacks</h4>
<p>I love Javascript.  It's so versatile.  Its powers can be used for good and evil.  Essentially, with the <a href="" target="_blank" rel="noopener noreferrer">SWEET32</a> vulnerability, an attacker can inject Javascript to override the "secure" flag on cookies.  This is definitely a man-in-the-middle attack, since the attacker intercepts the HTTPS connnection, especially during  <a href="https://blog.telepathics.xyz/web/websec/cors">cross-site</a> scripting.</p>
<blockquote>"With the SWEET32 vulnerability, it is now shown that an attacker can send in large volume of dummy data, and get blocks of cipher text that matches that of a customer.  It is possible because the 64-bit blocks used by 3DES-DES generates a lot of packets, which increases the probability of an encrypted packet of a customer and that of the attacker matching."</blockquote>
<p>- <a href="https://blogs.sap.com/2017/05/07/top-10-ssl-security-vulnerability-and-solution-part-1/" target="_blank" rel="noopener noreferrer">sap</a></p>

<h4>BEAST (Browser Exploit Against SSL/TLS)</h4>
<p>In September 2011, cipher-block-chaining was exploited in the SSL protocol that enabled decryption during authentication token passing in the web server and browser.  </p>

<h3>Active Network attacks</h3>
<!-- <p>SSLStrip, upside-down-ternet, arpspoof, dsniff</p> -->
<p></p>
